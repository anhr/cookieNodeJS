{"version":3,"file":"cookie.js","sources":["../index.js"],"sourcesContent":["/**\r\n * node.js version of the cookie.\r\n * Cookies let you store user information in web pages.\r\n * @see {@link https://www.w3schools.com/js/js_cookies.asp}\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nexport { isEnabled, set, setObject, get, getObject, remove, defaultCookie };\r\n\r\n/**\r\n * Is the cookie enabled in your web browser?\r\n * @returns {boolean} true if cookie enabled\r\n * \r\n * @example\r\n\tvar isCookieEnabled = cookie.isEnabled('age', 25);\r\n */\r\nfunction isEnabled() {\r\n\r\n\treturn navigator.cookieEnabled;\r\n\t//Enable cookie\r\n\t//Chrome: Settings/Show advanced settings.../Privacy/Content settings.../Cookies/Allow local data to be set\r\n\r\n}\r\n\r\n/**\r\n * Set a cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} value cookie value.\r\n * @param {Date} [cookie_date] expiry date (in UTC time). Optional.\r\n * @example\r\n\tcookie.set('age', 25);\r\n */\r\nfunction set( name, value, cookie_date ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\tvalue = value.toString();\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tif ( cookie_date === undefined ) {\r\n\r\n\t\tcookie_date = new Date();  // Curent date and time\r\n\t\tcookie_date.setTime( cookie_date.getTime() + 1000 * 60 * 60 * 24 * 365 );//expiry date is one year\r\n\r\n\t}\r\n\tdocument.cookie = name + \"=\" + value + ( ( typeof settings == 'undefined' ) ? '' : settings ) + \"; expires=\" + cookie_date.toGMTString();\r\n\tif ( document.cookie === '' )\r\n\t\tconsole.error( 'document.cookie is empty' );\r\n\r\n}\r\n\r\n/**\r\n * sets an object into cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} object an object for saving into cookie\r\n */\r\nfunction setObject( name, object ) {\r\n\r\n\tset( name, JSON.stringify( object ) );\r\n/*\r\n\tvar object = {};\r\n//\t\toptions = this.options;\r\n\tObject.keys( options.optionsDefault ).forEach( function ( key ) {\r\n\r\n\t\tobject[key] = options[key];\r\n\r\n\t} );\r\n\tif ( options.cookieObject === undefined )\r\n\t\toptions.cookieObject = this;\r\n\toptions.cookieObject.set( name, JSON.stringify( object ) );\r\n*/\r\n\r\n};\r\n\r\n/**\r\n * Get a cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} [defaultValue] cookie default value. Optional.\r\n * @returns {string} cookie value or defaultValue if cookie was not found.\r\n * @example\r\n\tvar age = cookie.get('age', 25);\r\n */\r\nfunction get( name, defaultValue ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tvar results = document.cookie.match( '(^|;) ?' + name + '=([^;]*)(;|$)' );\r\n\r\n\tif ( results )\r\n\t\treturn ( unescape( results[2] ) );\r\n\tif ( typeof defaultValue == 'undefined' )\r\n\t\treturn '';\r\n\treturn defaultValue;\r\n\r\n}\r\n\r\n/**\r\n * gets an object from cookie.\r\n * @param {string} name name of the object\r\n * @param {Object} optionsDefault returns this default object if named object is not exists in the cookie.\r\n * @returns an object\r\n */\r\n/*\r\nfunction getObject( name, objectDefault ) {\r\n\r\n\treturn JSON.parse( get( name, JSON.stringify( objectDefault ) ) );\r\n\r\n};\r\n*/\r\n/**\r\n * gets an object from cookie.\r\n * @param {string} name name of the object\r\n * @param {any} options load an object from cookie into options\r\n * @param {Object} optionsDefault copy to options this default object if named object is not exists in the cookie.\r\n */\r\nfunction getObject( name, options, optionsDefault ) {\r\n\r\n\tif ( options.optionsDefault === undefined )\r\n\t\toptions.optionsDefault = optionsDefault;\r\n\tnew defaultCookie().getObject( name, options, JSON.parse( options.cookie.get( name, JSON.stringify( optionsDefault ) ) ) );\r\n/*\r\n\tif ( !optionsDefault )\r\n\t\treturn;//object's settings is not saving\r\n\r\n\tif ( options.cookieObject === undefined )\r\n\t\toptions.cookieObject = options.cookie;\r\n\r\n\toptions.cookieObject.options = options;\r\n\tvar cookieObject = JSON.parse( options.cookieObject.get( name, JSON.stringify( options.optionsDefault ) ) );\r\n//\tvar cookieObject = options.cookieObject.getObject( name, optionsDefault );\r\n\tObject.keys( options.optionsDefault ).forEach( function ( key ) {\r\n\r\n\t\tif ( cookieObject[key] === undefined )\r\n\t\t\treturn;\r\n\t\tif ( typeof options.optionsDefault[key] === \"object\" )\r\n\t\t\tObject.keys( options.optionsDefault[key] ).forEach( function ( key2 ) {\r\n\r\n\t\t\t\tif ( options[key] === undefined ) options[key] = cookieObject[key];\r\n\t\t\t\tif ( cookieObject[key][key2] !== undefined ) {\r\n\r\n\t\t\t\t\tif ( typeof cookieObject[key][key2] === \"object\" )\r\n\t\t\t\t\t\tObject.keys( cookieObject[key][key2] ).forEach( function ( key3 ) {\r\n\r\n\t\t\t\t\t\t\tif ( options[key][key2] === undefined ) options[key][key2] = cookieObject[key][key2];\r\n\t\t\t\t\t\t\tif ( cookieObject[key][key2][key3] !== undefined )\r\n\t\t\t\t\t\t\t\toptions[key][key2][key3] = cookieObject[key][key2][key3];\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\toptions[key][key2] = cookieObject[key][key2];\r\n\t\t\t\t\t\tif ( options.commonOptions !== undefined )\r\n\t\t\t\t\t\t\toptions.commonOptions[key][key2] = cookieObject[key][key2];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\t\telse {\r\n\r\n\t\t\toptions[key] = cookieObject[key];\r\n\t\t\tif ( options.commonOptions !== undefined )\r\n\t\t\t\toptions.commonOptions[key] = cookieObject[key];\r\n\r\n\t\t}\r\n\r\n\t} );\r\n*/\r\n};\r\n\r\n/**\r\n * Remove cookie\r\n * @param {string} name cookie name.\r\n */\r\nfunction remove( name ) {\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tvar cookie_date = new Date();  // ������� ���� � �����\r\n\tcookie_date.setTime( cookie_date.getTime() - 1 );\r\n\tdocument.cookie = name += \"=; expires=\" + cookie_date.toGMTString();\r\n}\r\n\r\nfunction consoleCookieEnabled() {\r\n\r\n\tconsole.error( 'navigator.cookieEnabled = ' + navigator.cookieEnabled );\r\n\r\n}\r\n\r\n//Default cookie is not saving settings\r\nfunction defaultCookie( name ) {\r\n\r\n\tthis.get = function ( defaultValue ) {\r\n\r\n\t\t// Default cookie is not loading settings\r\n\t\treturn defaultValue;\r\n\r\n\t};\r\n\r\n\tthis.set = function () {\r\n\r\n\t\t// Default cookie is not saving settings\r\n\r\n\t};\r\n\r\n\tthis.getObject = function ( name, options, optionsDefault ) {\r\n\r\n\t\t// Default cookie is not loading objects\r\n//\t\treturn optionsDefault;\r\n\t\tif ( !optionsDefault )\r\n\t\t\treturn;//object's settings is not saving\r\n\r\n\t\tif ( options.optionsDefault === undefined )\r\n\t\t\toptions.optionsDefault = optionsDefault;\r\n\r\n\t\tif ( options.cookieObject === undefined )\r\n\t\t\toptions.cookieObject = options.cookie;\r\n\r\n\t\toptions.cookieObject.options = options;\r\n//\t\tvar cookieObject = JSON.parse( options.cookieObject.get( name, JSON.stringify( options.optionsDefault ) ) );\r\n\t\tvar cookieObject = optionsDefault;\r\n\t\tObject.keys( options.optionsDefault ).forEach( function ( key ) {\r\n\r\n\t\t\tif ( cookieObject[key] === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tif ( typeof options.optionsDefault[key] === \"object\" )\r\n\t\t\t\tObject.keys( options.optionsDefault[key] ).forEach( function ( key2 ) {\r\n\r\n\t\t\t\t\tif ( options[key] === undefined ) options[key] = cookieObject[key];\r\n\t\t\t\t\tif ( cookieObject[key][key2] !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( typeof cookieObject[key][key2] === \"object\" )\r\n\t\t\t\t\t\t\tObject.keys( cookieObject[key][key2] ).forEach( function ( key3 ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( options[key][key2] === undefined ) options[key][key2] = cookieObject[key][key2];\r\n\t\t\t\t\t\t\t\tif ( cookieObject[key][key2][key3] !== undefined )\r\n\t\t\t\t\t\t\t\t\toptions[key][key2][key3] = cookieObject[key][key2][key3];\r\n\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\toptions[key][key2] = cookieObject[key][key2];\r\n\t\t\t\t\t\t\tif ( options.commonOptions !== undefined )\r\n\t\t\t\t\t\t\t\toptions.commonOptions[key][key2] = cookieObject[key][key2];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\telse {\r\n\r\n\t\t\t\toptions[key] = cookieObject[key];\r\n\t\t\t\tif ( options.commonOptions !== undefined )\r\n\t\t\t\t\toptions.commonOptions[key] = cookieObject[key];\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tthis.setObject = function () {\r\n\r\n\t\t// Default cookie is not saving object's settings\r\n\r\n\t};\r\n\r\n\tthis.isTrue = function ( defaultValue ) {\r\n\r\n\t\treturn defaultValue;\r\n\r\n\t};\r\n\r\n};\r\n"],"names":["isEnabled","navigator","cookieEnabled","set","name","value","cookie_date","toString","undefined","Date","setTime","getTime","cookie","settings","toGMTString","document","console","error","setObject","object","JSON","stringify","get","defaultValue","results","match","unescape","getObject","options","optionsDefault","defaultCookie","parse","remove","consoleCookieEnabled","cookieObject","keys","forEach","key","Object","key2","key3","commonOptions","isTrue"],"mappings":"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"}